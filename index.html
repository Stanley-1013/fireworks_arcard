<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>給秈瑀的驚喜</title>
    <meta name="description" content="A special fireworks card.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #000;
        }
        
        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }
        
        .btn {
            padding: 10px 20px;
            background: #ff6b6b;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .btn:hover {
            background: #ff5252;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button class="btn" onclick="toggleFireworks()">🎆 播放/暫停煙火</button>
        <button class="btn" onclick="showMessage()">💝 顯示祝福</button>
    </div>

    <a-scene 
        background="color: #000022" 
        vr-mode-ui="enabled: false">
        
        <a-assets>
            <img id="message" src="./message.png">
            <a-asset-item id="fireworks-model" src="./fireworks.glb"></a-asset-item>
        </a-assets>
        
        <!-- 基本光源 -->
        <a-light type="ambient" color="#ffffff" intensity="0.5"></a-light>
        <a-light type="directional" position="0 1 0" color="#ffffff" intensity="0.5"></a-light>
        
        <!-- 煙火模型 - 簡化設置 -->
        <a-gltf-model 
            id="fireworks"
            src="#fireworks-model" 
            position="0 0 -3"
            scale="1 1 1"
            animation-mixer="clip: *; loop: repeat"
            visible="true">
        </a-gltf-model>
        
        <!-- 祝福圖片 -->
        <a-image 
            id="blessing-message"
            src="#message" 
            position="0 2 -3" 
            scale="2 1 1" 
            material="transparent: true"
            visible="false">
        </a-image>
        
        <!-- 簡單相機 -->
        <a-camera 
            position="0 1.6 0"
            look-controls="enabled: true">
        </a-camera>
        
    </a-scene>

    <script>
        let fireworksVisible = true;
        let messageVisible = false;
        
        function toggleFireworks() {
            const fireworks = document.querySelector('#fireworks');
            fireworksVisible = !fireworksVisible;
            fireworks.setAttribute('visible', fireworksVisible);
            
            console.log('煙火顯示狀態:', fireworksVisible);
        }
        
        function showMessage() {
            const message = document.querySelector('#blessing-message');
            messageVisible = !messageVisible;
            message.setAttribute('visible', messageVisible);
            
            console.log('祝福語顯示狀態:', messageVisible);
        }
        
        // 檢查模型載入狀態
        document.querySelector('#fireworks').addEventListener('model-loaded', () => {
            console.log('✅ 煙火模型載入成功');
        });
        
        document.querySelector('#fireworks').addEventListener('model-error', (e) => {
            console.error('❌ 煙火模型載入失敗:', e.detail);
            alert('煙火模型載入失敗，請檢查 fireworks.glb 檔案是否存在於正確位置');
        });
        
        // 檢查圖片載入
        document.querySelector('#blessing-message').addEventListener('materialtextureloaded', () => {
            console.log('✅ 祝福圖片載入成功');
        });
    </script>
</body>
</html>
