<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>å°ˆå±¬ç…™ç« AR å¡ç‰‡</title>
  <!-- A-Frame & AR.jsï¼ˆåŸºæ–¼ WebXR / WebRTC ç›¸æ©Ÿå­˜å–ï¼‰ -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.6/aframe/build/aframe-ar.js"></script>
  <!-- ç²’å­ç³»çµ±ï¼ˆç”¨ä¾†æ¨¡æ“¬ç…™ç«ï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
  <style>
    body { margin: 0; font-family: system-ui, -apple-system, 'PingFang TC', 'Noto Sans TC', sans-serif; }
    .ui { position: fixed; inset: 0 0 auto 0; display: flex; flex-wrap: wrap; gap: .5rem; padding: .75rem; z-index: 10; pointer-events: none; }
    .ui .card { pointer-events: auto; background: rgba(0,0,0,.55); color: #fff; padding: .5rem .75rem; border-radius: .75rem; backdrop-filter: blur(6px); }
    .qr-tip { position: fixed; right: .75rem; bottom: .75rem; background: rgba(0,0,0,.55); color: #fff; padding: .5rem .75rem; border-radius: .75rem; font-size: .875rem; }
    .link { color: #bdf; text-decoration: underline; }
  </style>
</head>
<body>
  <!-- UIï¼šæ•™å­¸èˆ‡ç¥ç¦æ–‡å­—ï¼ˆè¦†è“‹åœ¨ç›¸æ©Ÿä¸Šï¼‰ -->
  <div class="ui">
    <div class="card">
      <div>ğŸª„ <b>ä½¿ç”¨èªªæ˜</b>ï¼šå°‡ã€ŒHiro æ¨™è¨˜ã€ç½®æ–¼é¡é ­å‰ï¼ˆå¯åœ¨å¦ä¸€å°è£ç½®é¡¯ç¤º <a class="link" href="https://raw.githubusercontent.com/AR-js-org/AR.js/master/three.js/examples/marker-training/examples/pattern-files/hiro.png" target="_blank" rel="noopener">é€™å¼µåœ–</a>ï¼‰ï¼Œå°±æœƒåœ¨æ¨™è¨˜ä¸Šçœ‹åˆ° 3D ç…™ç«èˆ‡ç¥ç¦æ–‡å­—ã€‚</div>
    </div>
    <div class="card">ğŸ† <b>ç¥ç¦èª</b>ï¼š<span id="wish">é¡˜ä½ æ¯å¤©éƒ½èƒ½çœ‹åˆ°å°ˆå±¬çš„ç…™ç«ï¼</span></div>
  </div>
  <div class="qr-tip">æƒ³è‡ªè¨‚ç¥ç¦ï¼šåœ¨ç¶²å€å¾ŒåŠ  <code>?msg=ä½ çš„è©±</code></div>

  <!-- AR å ´æ™¯ï¼šä½¿ç”¨é è¨­ Hiro æ¨™è¨˜åšå¿«é€Ÿæ¸¬è©¦ï¼›å¾ŒçºŒå¯æ›æˆä½ çš„å°ˆå±¬åœ–æ¡ˆæ¨™è¨˜ -->
  <a-scene
    vr-mode-ui="enabled: false"
    embedded
    renderer="alpha: true; precision: mediump; antialias: true"
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;">

    <!-- ç’°å¢ƒå…‰ï¼Œè®“ 3D æ–‡å­—æ›´å¯è®€ -->
    <a-entity light="type: ambient; intensity: 1"></a-entity>
    <a-entity light="type: directional; intensity: .8" position="1 1 0"></a-entity>

    <!-- æ¨™è¨˜ï¼šå…ˆç”¨ hiro æ–¹ä¾¿ä½ ç«‹åˆ»æ¸¬ï¼Œä¹‹å¾Œå¯æ”¹æˆ <a-marker type="pattern" url="./your-marker.patt"> -->
    <a-marker preset="hiro">
      <!-- ç…™ç« 1ï¼šå‘ä¸Šçˆ†é–‹çš„ç²’å­ï¼ˆé–“æ­‡è§¸ç™¼ï¼‰ -->
      <a-entity id="fw1" position="0 0 0" particle-system="preset: dust; color: #fff, #ffd166, #ef476f, #06d6a0, #118ab2; particleCount: 400; size: 2; maxAge: 1.6; velocityValue: 0 4 0; accelerationValue: 0 -3 0;"></a-entity>

      <!-- ç…™ç« 2ï¼šç’°ç‹€çˆ†ç ´ -->
      <a-entity id="fw2" position="0.6 0.2 0" particle-system="type: circle; color: #ffffff, #b5179e, #560bad; particleCount: 240; size: 1.6; maxAge: 1.2; velocityValue: 0 0 0;"></a-entity>

      <!-- 3D ç¥ç¦æ–‡å­—ï¼ˆå¯ç”±ç¶²å€åƒæ•¸è¦†è“‹ï¼‰ -->
      <a-entity position="0 -0.25 0" rotation="-90 0 0" scale="0.4 0.4 0.4">
        <a-text id="msg3d" value="Happy Fireworks!" color="#ffffff" align="center" anchor="center" negating="false"></a-text>
      </a-entity>
    </a-marker>

    <!-- ç›¸æ©Ÿ -->
    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // è®“ç…™ç«é€±æœŸæ€§è§¸ç™¼ï¼ˆç°¡å–®çš„çˆ†ç ´ç¯€å¥ï¼‰
    const burst = (el) => {
      // é€éåˆ‡æ›å±¬æ€§å€¼è®“ç²’å­é‡æ–°ç”Ÿæˆ
      const cfg = el.getAttribute('particle-system') || '';
      el.setAttribute('particle-system', cfg + '; enabled: false');
      // ä¸‹ä¸€ç¦å†æ‰“é–‹é¿å…åŒå¹€ç„¡æ•ˆ
      requestAnimationFrame(() => el.setAttribute('particle-system', cfg + '; enabled: true'));
    };

    const fw1 = document.getElementById('fw1');
    const fw2 = document.getElementById('fw2');

    setInterval(() => burst(fw1), 1500);
    setInterval(() => burst(fw2), 2200);

    // æ”¯æ´ ?msg= è‡ªè¨‚ç¥ç¦ï¼ŒæœƒåŒæ­¥åˆ°ä¸Šæ–¹ UI èˆ‡ 3D æ–‡å­—
    const params = new URLSearchParams(location.search);
    const msg = (params.get('msg') || '').trim();
    if (msg) {
      document.getElementById('wish').textContent = msg;
      document.getElementById('msg3d').setAttribute('value', msg);
    }
  </script>
</body>
</html>
