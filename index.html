<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>çµ¦ç§ˆç‘€çš„é©šå–œ</title>
    <meta name="description" content="A special fireworks card.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #000;
        }
        
        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            flex-direction: column;
        }
        
        .btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border: none;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
        
        .instructions {
            position: fixed;
            bottom: 20px;
            left: 20px;
            color: white;
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button class="btn" onclick="playFireworks()">ğŸ† æ’­æ”¾ç…™ç«</button>
        <button class="btn" onclick="showMessage()">ğŸ’ é¡¯ç¤ºç¥ç¦</button>
        <button class="btn" onclick="resetScene()">ğŸ”„ é‡æ–°é–‹å§‹</button>
    </div>
    
    <div class="instructions">
        æ‹–æ‹½æ»‘é¼ è½‰å‹•è¦–è§’ | æ»¾è¼ªç¸®æ”¾
    </div>

    <a-scene 
        background="color: #000011" 
        vr-mode-ui="enabled: false"
        cursor="rayOrigin: mouse">
        
        <a-assets>
            <img id="message" src="./message.png">
            <a-asset-item id="fireworks" src="./fireworks.glb"></a-asset-item>
        </a-assets>
        
        <!-- ç’°å¢ƒå…‰å’Œé»å…‰æº -->
        <a-light type="ambient" color="#404040" intensity="0.3"></a-light>
        <a-light type="point" position="0 5 0" color="#ffffff" intensity="1"></a-light>
        
        <!-- ç…™ç«æ¨¡å‹ -->
        <a-entity id="fireworks-entity" position="0 0 -5" visible="false">
            <a-gltf-model 
                id="fireworks-model"
                src="#fireworks" 
                scale="3 3 3"
                animation-mixer="clip: *; loop: repeat; timeScale: 1">
            </a-gltf-model>
        </a-entity>
        
        <!-- ç¥ç¦åœ–ç‰‡ -->
        <a-entity id="message-entity" position="0 2 -4" visible="false">
            <a-image 
                src="#message" 
                scale="3 2 1" 
                material="transparent: true; opacity: 0"
                animation__fadein="property: material.opacity; from: 0; to: 1; dur: 2000; easing: easeInOutQuad">
            </a-image>
        </a-entity>
        
        <!-- ç²’å­æ•ˆæœèƒŒæ™¯ -->
        <a-entity id="stars" position="0 0 0">
            <a-sphere position="10 8 -10" radius="0.1" color="#ffffff" opacity="0.8"></a-sphere>
            <a-sphere position="-8 6 -15" radius="0.1" color="#ffffff" opacity="0.6"></a-sphere>
            <a-sphere position="5 -3 -12" radius="0.1" color="#ffffff" opacity="0.7"></a-sphere>
            <a-sphere position="-12 -5 -8" radius="0.1" color="#ffffff" opacity="0.5"></a-sphere>
            <a-sphere position="15 2 -20" radius="0.1" color="#ffffff" opacity="0.9"></a-sphere>
        </a-entity>
        
        <!-- ç›¸æ©Ÿæ§åˆ¶ -->
        <a-camera 
            position="0 1.6 0"
            look-controls="enabled: true"
            wasd-controls="enabled: false">
        </a-camera>
        
    </a-scene>

    <script>
        let fireworksPlaying = false;
        let messageVisible = false;
        
        // æ’­æ”¾ç…™ç«
        function playFireworks() {
            const fireworksEntity = document.querySelector('#fireworks-entity');
            const fireworksModel = document.querySelector('#fireworks-model');
            
            fireworksEntity.setAttribute('visible', true);
            
            // æ·»åŠ æ—‹è½‰å‹•ç•«
            fireworksEntity.setAttribute('animation', {
                property: 'rotation',
                to: '0 360 0',
                dur: 20000,
                loop: true,
                easing: 'linear'
            });
            
            // æ·»åŠ ä¸Šä¸‹æµ®å‹•
            fireworksEntity.setAttribute('animation__float', {
                property: 'position',
                to: '0 1 -5',
                dur: 3000,
                direction: 'alternate',
                loop: true,
                easing: 'easeInOutSine'
            });
            
            fireworksPlaying = true;
            console.log('ç…™ç«é–‹å§‹æ’­æ”¾');
        }
        
        // é¡¯ç¤ºç¥ç¦èª
        function showMessage() {
            const messageEntity = document.querySelector('#message-entity');
            messageEntity.setAttribute('visible', true);
            
            // æ·»åŠ ç¸®æ”¾å‹•ç•«
            messageEntity.setAttribute('animation__scale', {
                property: 'scale',
                from: '0.1 0.1 0.1',
                to: '3 2 1',
                dur: 1500,
                easing: 'easeOutBounce'
            });
            
            messageVisible = true;
            console.log('ç¥ç¦èªé¡¯ç¤º');
        }
        
        // é‡æ–°é–‹å§‹
        function resetScene() {
            const fireworksEntity = document.querySelector('#fireworks-entity');
            const messageEntity = document.querySelector('#message-entity');
            
            fireworksEntity.setAttribute('visible', false);
            messageEntity.setAttribute('visible', false);
            
            // é‡ç½®å‹•ç•«
            fireworksEntity.removeAttribute('animation');
            fireworksEntity.removeAttribute('animation__float');
            messageEntity.removeAttribute('animation__scale');
            
            fireworksPlaying = false;
            messageVisible = false;
            
            console.log('å ´æ™¯é‡ç½®');
        }
        
        // è‡ªå‹•æ’­æ”¾åºåˆ—
        function autoPlay() {
            setTimeout(() => {
                playFireworks();
            }, 1000);
            
            setTimeout(() => {
                showMessage();
            }, 3000);
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•æ’­æ”¾
        window.addEventListener('load', () => {
            setTimeout(autoPlay, 2000);
        });
        
        // éŒ¯èª¤è™•ç†
        document.querySelector('#fireworks-model').addEventListener('model-error', (e) => {
            console.error('ç…™ç«æ¨¡å‹è¼‰å…¥å¤±æ•—:', e);
            alert('ç…™ç«æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèª fireworks.glb æª”æ¡ˆå­˜åœ¨');
        });
        
        document.querySelector('a-image').addEventListener('materialtextureloaded', () => {
            console.log('ç¥ç¦åœ–ç‰‡è¼‰å…¥æˆåŠŸ');
        });
    </script>
</body>
</html>
